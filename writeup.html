<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Final Paper - 20240510copy</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="performance-analysis-of-predictive-models-for-sensor-fault-detection-from-traditional-methods-to-deep-learning-approaches">Performance Analysis of Predictive Models for Sensor Fault Detection: From Traditional Methods to Deep Learning Approaches</h1>
<h2 id="abstract">Abstract</h2>
<p>In this study, we present a comprehensive evaluation of various modeling techniques for sensor fault detection using the time series of sensor measurements. Our approach involves experimenting with combinations of a diverse range of models for predicting sensor measurements and anomalous results. For predicting measurements, we include a traditional statistical method SARIMAX, machine learning algorithms like random forest, gradient boosting, and k-nearest neighbors, as well as advanced deep learning architectures including recurrent neural networks (RNNs), long short-term memory networks (LSTMs), and gated recurrent units (GRUs). For predicting anomalies, we include univariate outlier detection methods on residuals such as with z-scores and interquartile ranges, as well as multivariate outlier detection methods on predicted and actual values, such as with isolation forest and clustering techniques.</p>
<p>Through extensive experimentation and comparative analysis on real-world sensor datasets, we systematically assess the performance of each method in terms of computational efficiency and detection accuracy. By empirically evaluating the effectiveness of different approaches, we aim to identify the most suitable models for sensor fault detection. We aim to provide valuable insights into the strengths and limitations of each modeling technique, enabling practitioners to make informed decisions when implementing robust sensor fault detection systems in industrial environments.</p>
<h2 id="introduction">Introduction</h2>
<p>Sensor fault detection is a crucial aspect of ensuring the reliability and accuracy of sensor networks. It involves identifying anomalies or faults in sensor data that may arise due to various reasons such as sensor malfunctions, environmental factors, or communication errors. De Silva et al. stress the importance of robust fault detection in sensor networks to enhance performance and reduce environmental impact (de Silva et al., 2020). Dong et al. highlight the increasing research interest in fault detection for sensor networks due to the growing demand for higher performance, safety, and reliability standards (Dong et al., 2014).</p>
<p>One common method involves utilizing symptom signals, pattern recognition, or analyzing the contributions of sensors to process models to detect sensor faults (Brunner et al., 2021). Additionally, researchers have explored the use of Convolutional Neural Networks (CNNs) for fault detection in aero-engine sensors, emphasizing the importance of detecting and isolating sensor faults to enhance system reliability (Du et al., 2022).</p>
<p>In the realm of wireless sensor networks (WSNs), distributed fault detection schemes have been developed to capitalize on the spatial correlations of sensor measurements for fault detection (Dong et al., 2014). These schemes aim to enhance fault detection accuracy and efficiency in large-scale sensor networks. Furthermore, fault detection methods based on credibility and cooperation have been suggested for WSNs in smart grids, highlighting the significance of collaborative fault detection approaches in complex systems (Shao et al., 2017). By integrating model-based algorithms with signal-based techniques, researchers have achieved effective fault detection and isolation for current sensors in various systems (Mollet et al., 2013). Moreover, the advancement of fault-tolerant control systems and fault diagnosis algorithms has been pivotal in addressing sensor faults in different applications, such as wind turbines and gas turbines (Odgaard et al., 2013; Cruz-Manzo et al., 2022). These systems aim to detect, isolate, and accommodate sensor faults in real-time to ensure the continuous operation of critical infrastructure.</p>
<p>Another approach to sensor fault detection involves the use of physics-informed machine learning techniques. De Silva et al. (2020) discusses the application of a moving average of the innovation covariance to identify anomalous behavior in sensor data. Additionally, the authors mention the utilization of the Dynamic Mode Decomposition (DMD) algorithm for system identification in sensor fault detection, particularly in cases with strongly nonlinear dynamics. DMD is known for extracting coherent spatio-temporal structures from complex data, making it suitable for detecting faults in sensor networks.</p>
<p>On the other hand, Dong et al. (2014) focus on distributed filtering and fault detection in sensor networks. They propose algorithms that enable distributed and localized fault identification by leveraging information from neighboring sensors. The authors also discuss the importance of distributed estimation and fault detection in large-scale networked systems, emphasizing the need to understand the impact of distributed information structures on filtering and fault detection in sensor networks.</p>
<p>Data-driven algorithms are essential for automating the detection process. By employing machine learning methods that approximate the evolution of measurements over time, deviations between actual measurements and estimated values can be utilized to identify anomalous behavior indicative of sensor faults. Integrating other sensor measurements into decision-making processes, such as using a decision tree, can enhance the accuracy of fault detection (de Silva et al., 2020).</p>
<p>In conclusion, sensor fault detection plays a crucial role in maintaining the reliability and performance of sensor networks. Through the utilization of advanced technologies like artificial intelligence, distributed algorithms, and fault-tolerant control systems, as well as by combining physics-informed machine learning techniques with distributed filtering algorithms, researchers aim to develop robust and efficient methods for detecting faults in sensor data, thereby ensuring the integrity and accuracy of sensor networks.</p>
<h2 id="about-the-data">About the Data</h2>

<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Timestamp</td>
<td>Date in ISO 8601 format</td>
<td>2017-03-01T23:20:00+03:00</td>
</tr>
<tr>
<td>Value</td>
<td>Decimal value</td>
<td>18.4798069</td>
</tr>
</tbody>
</table><p>Our data is a time series of sensor measurements, taken from a PT100 temperature sensor in an industrial environment, with dust and vibrations.</p>
<p>We define anomalies as large deviations from the rest of the data. Out of the 62,629 total observations, we assume 8 of them are anomalous. The timestamps range from August 2016 to September 2017.</p>
<p>The timestamps in the data are not consistently spaced apart. Earlier timestamps are in 1-hour intervals, but by the end, they are in 5-minute intervals. There are many gaps in between due to sensor disconnection or failure, though particularly large gaps (up to 21 days) are scarce.</p>
<p>This dataset is free to the public on Kaggle and is licensed under Open Database License (ODbL) v1.0 (Möbius, 2020).</p>
<h2 id="methods">Methods</h2>
<p>To give more information to our predictive models, each value has been attached its preceding values from within a “window” of set length. That is, given a window of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span></span></span></span></span>, each value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span> at time <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathnormal">t</span></span></span></span></span> is associated with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{t-1}, y_{t-2}, …, y_{t-n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. This form of new feature data is used as inputs from which our models derive insights.</p>
<p>We use machine learning clustering algorithms to predict anomalous data, specifically the scikit-learn implementations of isolation forest (with contamination set to the proportion of anomalies in our data), k-means clustering, and density-based spatial clustering of applications with noise (DBSCAN). These models are fed the new feature data, then have the smallest cluster of values be labelled as anomalous. In an altered version of this approach, values are labelled as anomalous if the cluster they are in is smaller than a set threshold.</p>
<p>We then try a different procedure: we add an intermediary step in the pipeline where we fit another model on the first 20% of the new feature data, with the previous values as the input data <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span></span></span></span></span> and the current values as the targets <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>. Then, we use the model’s predictions of all the feature data along with their associated actual values to predict anomalous data. We use a statistical time series model, the autoregressive moving-average (ARMA) model from the Statsmodels library (where the targets are the endogenous values and the input data the exogenous values); machine learning regressors, using random forest, gradient boosting, and k-nearest neighbors algorithms from Scikit-Learn; and deep learning models, which are a simple recurrent neural network (RNN), a long short-term memory (LSTM) network, and a gated recurrent unit (GRU) network built using the Keras library.</p>
<p>We also try using statistical methods for predicting anomalies on residuals, calculated using both the predictions and the actual values. The first of the two methods are calculating z-scores: we standardize the residuals and perform a statistical z-test (with significance level <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>) to identify statistically significant residuals as anomalies. The other way is with Tukey’s method: a residual <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> at time <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathnormal">t</span></span></span></span></span> is considered anomalous if</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>&lt;</mo><msub><mi>Q</mi><mn>1</mn></msub><mtext>–</mtext><mi>k</mi><mi>I</mi><mtext>&nbsp;or&nbsp;</mtext><msub><mi>x</mi><mi>t</mi></msub><mo>&gt;</mo><msub><mi>Q</mi><mn>3</mn></msub><mo>+</mo><mi>k</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">x_t &lt; Q_1 – kI \text{  or  } x_t &gt; Q_3 + kI</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">–</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mord text"><span class="mord">&nbsp;or&nbsp;</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span></span></span></span></span></span></p>
<p>where we have the first and third quartiles of the residuals, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">Q_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the interquartile range <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span></span></span></span></span>, and coefficient <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>, which is a weight for outlier sensitivity. Typically, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> is set to 1.5, but we will use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">k=25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">25</span></span></span></span></span> for the dataset we are using. This value is specifically chosen to be a small as possible to prioritize correctly labelling anomalous data over normal data, although we still aim to achieve the highest accuracy possible (ignoring the reasonably mislabeled normal values).</p>
<pre class=" language-mermaid"><svg id="mermaid-svg-BXfTjW4eHqumKeDc" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="348.03125" style="max-width: 401.47918701171875px;" viewBox="0 0 401.47918701171875 348.03125"><style>#mermaid-svg-BXfTjW4eHqumKeDc{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-BXfTjW4eHqumKeDc .error-icon{fill:#552222;}#mermaid-svg-BXfTjW4eHqumKeDc .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-BXfTjW4eHqumKeDc .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-BXfTjW4eHqumKeDc .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-BXfTjW4eHqumKeDc .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-BXfTjW4eHqumKeDc .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-BXfTjW4eHqumKeDc .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-BXfTjW4eHqumKeDc .marker{fill:#666;stroke:#666;}#mermaid-svg-BXfTjW4eHqumKeDc .marker.cross{stroke:#666;}#mermaid-svg-BXfTjW4eHqumKeDc svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-BXfTjW4eHqumKeDc .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-BXfTjW4eHqumKeDc .cluster-label text{fill:#333;}#mermaid-svg-BXfTjW4eHqumKeDc .cluster-label span{color:#333;}#mermaid-svg-BXfTjW4eHqumKeDc .label text,#mermaid-svg-BXfTjW4eHqumKeDc span{fill:#000000;color:#000000;}#mermaid-svg-BXfTjW4eHqumKeDc .node rect,#mermaid-svg-BXfTjW4eHqumKeDc .node circle,#mermaid-svg-BXfTjW4eHqumKeDc .node ellipse,#mermaid-svg-BXfTjW4eHqumKeDc .node polygon,#mermaid-svg-BXfTjW4eHqumKeDc .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-BXfTjW4eHqumKeDc .node .label{text-align:center;}#mermaid-svg-BXfTjW4eHqumKeDc .node.clickable{cursor:pointer;}#mermaid-svg-BXfTjW4eHqumKeDc .arrowheadPath{fill:#333333;}#mermaid-svg-BXfTjW4eHqumKeDc .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-BXfTjW4eHqumKeDc .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-BXfTjW4eHqumKeDc .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-BXfTjW4eHqumKeDc .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-BXfTjW4eHqumKeDc .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-BXfTjW4eHqumKeDc .cluster text{fill:#333;}#mermaid-svg-BXfTjW4eHqumKeDc .cluster span{color:#333;}#mermaid-svg-BXfTjW4eHqumKeDc div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-BXfTjW4eHqumKeDc:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-BXfTjW4eHqumKeDc flowchart-v2{fill:apa;}</style><g transform="translate(0, 0)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M121.24353489396519,49.71875L108.44469900526559,53.885416666666664C95.64586311656599,58.052083333333336,70.04819133916679,66.38541666666667,57.249355450467185,80.421875C44.45051956176758,94.45833333333333,44.45051956176758,114.19791666666667,44.45051956176758,138.390625C44.45051956176758,162.58333333333334,44.45051956176758,191.22916666666666,47.94571460723878,214.171875C51.44090965270996,237.11458333333334,58.431299743652346,254.35416666666666,61.926494789123545,262.9739583333333L65.42168983459473,271.59375" id="L-Start-A" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Start LE-A" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M215.405667560064,49.71875L221.41574706034794,53.885416666666664C227.42582656063186,58.052083333333336,239.4459855611997,66.38541666666667,245.45606506148366,74.71875C251.46614456176758,83.05208333333333,251.46614456176758,91.38541666666667,251.46614456176758,95.55208333333333L251.46614456176758,99.71875" id="L-Start-B" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Start LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M209.25057688626376,168.15625L198.6163661552198,176.77604166666666C187.98215542417583,185.39583333333334,166.7137339620879,202.63541666666666,149.44463449998335,219.875C132.1755350378788,237.11458333333334,118.90575757575759,254.35416666666666,112.27086884469698,262.9739583333333L105.63598011363636,271.59375" id="L-B-A" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-A" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M271.8802217726274,168.15625L277.0225806438562,176.77604166666666C282.16493951508494,185.39583333333334,292.44965725754247,202.63541666666666,297.59201612877126,219.875C302.734375,237.11458333333334,302.734375,254.35416666666666,302.734375,262.9739583333333L302.734375,271.59375" id="L-B-C" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(145.4453125, 219.875)"><g class="label" transform="translate(-49.692710876464844, -26.71875)"><foreignObject width="99.38542175292969" height="53.4375"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Predicted and <br> actual values</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(302.734375, 219.875)"><g class="label" transform="translate(-32.84375, -13.359375)"><foreignObject width="65.6875" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Residuals</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-Start-152" transform="translate(185.31770706176758, 28.859375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-88.25" y="-20.859375" width="176.5" height="41.71875"></rect><g class="label" style="" transform="translate(-80.75, -13.359375)"><foreignObject width="161.5" height="26.71875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Generate feature data</span></div></foreignObject></g></g><g class="node default default" id="flowchart-A-153" transform="translate(79.296875, 305.8125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-71.296875" y="-34.21875" width="142.59375" height="68.4375"></rect><g class="label" style="" transform="translate(-63.796875, -26.71875)"><foreignObject width="127.59375" height="53.4375"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Predict anomalies <br> with clustering</span></div></foreignObject></g></g><g class="node default default" id="flowchart-B-155" transform="translate(251.46614456176758, 133.9375)"><rect class="basic label-container" style="" rx="0" ry="0" x="-97.296875" y="-34.21875" width="194.59375" height="68.4375"></rect><g class="label" style="" transform="translate(-89.796875, -26.71875)"><foreignObject width="179.59375" height="53.4375"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Fit model on data <br> and generate predictions</span></div></foreignObject></g></g><g class="node default default" id="flowchart-C-159" transform="translate(302.734375, 305.8125)"><rect class="basic label-container" style="" rx="0" ry="0" x="-90.74479675292969" y="-34.21875" width="181.48959350585938" height="68.4375"></rect><g class="label" style="" transform="translate(-83.24479675292969, -26.71875)"><foreignObject width="166.48959350585938" height="53.4375"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Predict anomalies <br> with statisical methods</span></div></foreignObject></g></g></g></g></g></svg></pre>
<p>For the context of this project, the first priority is precisely identifying all anomalies in the data, while overall accuracy is second. Furthermore, pipelines with any random components (i.e., isolation forest, random forest, k-means, deep learning models) are run multiple times to check for consistency between results.</p>
<p>Here are the main takeaways from our analysis for the dataset and models we used:</p>
<ol>
<li>
<p>Using only the clustering algorithms to predict anomalies is effective, but it does not work when you include previous values as inputs</p>
</li>
<li>
<p>The most universally effective approach is fitting one of the models used in the project on the data, then applying the z-test or Tukey’s method on residuals or k-means clustering on predicted and actual values</p>
</li>
<li>
<p>Using DBSCAN to predict anomalies is effective when a cluster size threshold for determining anomaly clusters is used</p>
</li>
<li>
<p>Isolation forest for anomaly detection is consistently unreliable</p>
<ul>
<li>Often returns varying results</li>
<li>May not correctly predict all anomalies</li>
</ul>
</li>
</ol>
<p>Because the sensor dataset we used had wildly inconsistent time intervals between values, we were unable to train an ARMA model that could be used for forecasting. Further research could look into how an ARMA model trained entirely on non-anomalous data can perform.</p>
<h2 id="discussion-and-inferences">Discussion and Inferences</h2>
<p>Our first method of using only clustering algorithms to predict anomalies found consistent success. The isolation forest, k-means, and DBSCAN algorithms all consistently returned perfect results, but only when previous values are excluded as inputs. Thus, the addition of previous values as features only harms performance.</p>
<p>The table shown below displays a quick summary of our research findings on our second method, where we include our intermediary step. Precision refers to the ability to identify all anomalies in the dataset, while accuracy refers to the ability to label only a negligible proportion of the data incorrectly (less than 0.1%). Consistency is determined by whether running the same pipeline multiple times changes the results in any meaningful way, such as by significant changes in accuracy or precision.</p>

<table>
<thead>
<tr>
<th></th>
<th>Z-Score</th>
<th>Tukey</th>
<th>Isolation Forest</th>
<th>K-Means</th>
<th>DBSCAN</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARMA</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC</td>
<td>✔️</td>
<td>✔️*</td>
</tr>
<tr>
<td>Random Forest</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️*</td>
</tr>
<tr>
<td>Gradient Boosted</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️*</td>
</tr>
<tr>
<td>K-Nearest Neighbors</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️</td>
</tr>
<tr>
<td>Simple RNN</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️*</td>
</tr>
<tr>
<td>LSTM</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️*</td>
</tr>
<tr>
<td>GRU</td>
<td>✔️</td>
<td>✔️</td>
<td>❌PREC, ACC, CONS</td>
<td>✔️</td>
<td>✔️</td>
</tr>
</tbody>
</table><p>✔️: Acceptable results<br>
❌PREC: Bad precision<br>
❌ACC: Bad accuracy<br>
❌CONS: Bad consistency<br>
*Altered approach (read more below)</p>
<p>The window length used to generate the feature data is different for some pipelines. Those that used the ARMA model had 0, the regression models had 10, and the deep learning models had 10.</p>
<p>We tested multiple window lengths for the ARMA model, and we found that our results are best when the length is set to 5. Further research may be conducted to look into the how well our procedures with the ARMA model performs with different window lengths on different datasets so that we may understand the conditions it performs well in.</p>
<p>The most significant, and perhaps most important, pattern to note, are the consistently acceptable results given by using z-scores, Tukey’s method, and k-means clustering to predict anomalies, having been shown to be consistently precise and accurate. In particular, k-means consistently yielded perfect results for all its model pairs.</p>
<p>The DBSCAN algorithm shows success as well, usually when using the altered approach, where all clusters with a size below a set threshold have their values labelled as anomalous. It was a response to a common pattern to return multiple small clusters, where the anomalous cluster is often not the smallest of them. Therefore, our initial approach fails because we only label the values in the smallest cluster as anomalous. In our project, we chose a threshold of either 10 or 50, depending on the DBSCAN results. Further research might look into ways of determining the best threshold for a dataset and pipeline or ways of tuning hyperparameters to achieve better results so that we can discard the use of a threshold. The intuition is that we may find solutions for greater adaptability to changing underlying conditions in the real-world context that might affect future data.</p>
<p>Isolation forest is rarely able to predict all anomalies. When paired with the ARMA model or a regression model, it is consistently unable to accurately label the earliest anomaly, even when it correctly labels every other value. Even with its contamination, the set proportion of anomalies in the data, increased by 0.0001, this pattern persists even when it correctly labels every other anomaly and incorrectly labels some normal values. This is possibly because of how the first model predicts values: since the first anomaly is the only one of the eight that does not have other anomalies as its previous values, the resulting prediction is a normal value, while the other anomalies’ predicted values are different, and so the first anomaly becomes isolated from the other anomalies. With the deep learning models, isolation forest is incredibly inconsistent in its predictions and very frequently fails to precisely detect any of the anomalies. On the occasion it does, it usually fails to detect all of them. The results of the neural networks also affect the variability of the cluster results on an inconsistent basis, and thus exaggerates the variability problem already apparent with the regression models.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Employing machine learning clustering algorithms, we observed promising results in anomaly detection. We explored an alternative approach involving an intermediary step, wherein the ARMA model and various regression and deep learning models were employed to predict values, followed by anomaly detection based on statistical methods on residuals or clustering on predicted and actual values. Notably, our findings underscored the efficacy of certain methods for predicting anomalies: z-scores, Tukey’s method, k-means clustering, and DBSCAN in achieving consistent precision and accuracy in anomaly detection.</p>
<p>The success of these pipelines was determined more so by the anomaly prediction model rather than the regression model.  As such, it would be more prudent to research anomaly prediction methods rather than those for regression.</p>
<p>In conclusion, our study provides valuable insights into anomaly detection methodologies for irregular time series data. The identified strengths and limitations of various approaches lay the groundwork for future research aimed at enhancing anomaly detection accuracy and reliability in similar industrial settings.</p>
<h2 id="references">References</h2>
<p>[1] Brunner, V., Siegl, M., Geier, D., &amp; Becker, T. (2021). Challenges in the development of soft sensors for bioprocesses: a critical review. Frontiers in Bioengineering and Biotechnology, 9. <a href="https://doi.org/10.3389/fbioe.2021.722202">https://doi.org/10.3389/fbioe.2021.722202</a></p>
<p>[2] Cruz-Manzo, S., Panov, V., &amp; Bingham, C. (2022). Gas turbine sensor fault diagnostic system in a real-time executable digital-twin… <a href="https://doi.org/10.33737/gpps22-tc-109">https://doi.org/10.33737/gpps22-tc-109</a></p>
<p>[3] de Silva, B. M., Callaham, J., Jonker, J., Goebel, N., Klemisch, J., McDonald, D., Hicks, N., Kutz, J. N., Brunton, S. L., &amp; Aravkin, A. Y. (2020, June 23). Physics-informed machine learning for Sensor Fault Detection with Flight Test Data. <a href="http://arXiv.org">arXiv.org</a>. <a href="https://arxiv.org/abs/2006.13380">https://arxiv.org/abs/2006.13380</a></p>
<p>[4] Dong, H., Wang, Z., Ding, S., &amp; Gao, H. (2014). A survey on distributed filtering and fault detection for sensor networks. Mathematical Problems in Engineering, 2014, 1-7. <a href="https://doi.org/10.1155/2014/858624">https://doi.org/10.1155/2014/858624</a></p>
<p>[5] Du, X., Chen, J., Zhang, H., &amp; Wang, J. (2022). Fault detection of aero-engine sensor based on inception-cnn. Aerospace, 9(5), 236. <a href="https://doi.org/10.3390/aerospace9050236">https://doi.org/10.3390/aerospace9050236</a></p>
<p>[6] Möbius (2020). Sensor Fault Detection Data [Dataset]. Schneider-Electric. <a href="https://www.kaggle.com/datasets/arashnic/sensor-fault-detection-data">https://www.kaggle.com/datasets/arashnic/sensor-fault-detection-data</a></p>
<p>[7] Mollet, Y., Gyselinck, J., &amp; Meinguet, F. (2013). Current sensor fault detection and isolation combining model-based and signal-based algorithms in pmsg drives… <a href="https://doi.org/10.1109/epe.2013.6631961">https://doi.org/10.1109/epe.2013.6631961</a></p>
<p>[8] Odgaard, P., Stoustrup, J., &amp; Kinnaert, M. (2013). Fault-tolerant control of wind turbines: a benchmark model. Ieee Transactions on Control Systems Technology, 21(4), 1168-1182. <a href="https://doi.org/10.1109/tcst.2013.2259235">https://doi.org/10.1109/tcst.2013.2259235</a></p>
<p>[9] Shao, S., Guo, S., &amp; Qiu, X. (2017). Distributed fault detection based on credibility and cooperation for wsns in smart grids. Sensors, 17(5), 983. <a href="https://doi.org/10.3390/s17050983">https://doi.org/10.3390/s17050983</a></p>
</div>
</body>

</html>
